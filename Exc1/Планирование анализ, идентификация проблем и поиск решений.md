## Идентификация существующих и потенциальных проблемных мест

Исходя из описания выявлены следующие проблемы:
1. Некоторые заказы "теряются" в системе при прохождении ЖЦ. (Известно, что задержка заказов происходит не из-за 
недостатка производственных мощностей). Причина неизвестна.
2. Внедрение API привело к увеличению жалоб на просроченные заказы. Причина неизвестна.
3. Долгое отображение заказов в интерфейсе MES. Предприняты попытки оптимизации путем добавления фильтрации и пагинации, 
но решение оказалось нежизнеспособным по причине несоответствия бизнес требованиям.
4. Деплой в release и production окружение производится вручную. Это чревато ошибками развертывания (человеческий фактор), 
а также на это затрачиваются человеческие ресурсы.
5. Тестирование функциональных требований осуществляется путем ручных прогонов E2E сценариев тестированием. Отсутствие 
предварительно юнит и интеграционного тестирования может приводить к большему количеству дефектов при прогоне E2E тестов.
Сам же прогон E2E может занимать значительное количество времени. Каждая правка дефекта требует повтороного прогона E2E теста.
6. Запросы на чтение (со стороны CRM) и запись (со стороны интернет магазина) обрабатывает одна СУБД. Что может являться
узким местом в производительности системы.

Резюмируя:
1. Страдает observability системы:  
    1.1. Нет системы мониторинга, которая бы показывала насколько хорошо система справляется с нагрузкой;  
    1.2. Нет системы логирования, чтобы понимать когда в системе происходит системная ошибка;  
    1.3. Нет системы оповещений (alerting) о проблемах, для своевременной реакции со стороны команды.  
    1.4. Нет системы трейсинга. Система является многокомпонентной, важно отслеживать на каком этапе выполнения запроса 
    могут возникать проблемы  
2. Страдает надежность системы.  
    2.1. Отстутствуют тесты, которые прогоняются автоматически. 
    2.2. Проверки нефункциональных требований (например, нагрузочное тестирование) не проводится. Что может приводить к 
    непредсказуемым последствиям в периоды пиковых нагрузок.
3. Добавление нового функционала будет вести к увеличению пользовательских сценариев = увеличение E2E сценариев. Без должной
автоматизиции тестирования это неминуемо будет приводить к росту количества дефектов, выявляемых при ручном прогоне,
и, следовательно, увеличению трудозатрат со стороны тестирования. Что, в свою очередь, будет приводить к задержке релиза.
4. Отсутствует слой кэшированния данных. В некоторых случаях это может помочь уменьшить задержки при обработке запросов
5. Отсуствие процесса CI/CD для релизного и промышленного окружения. Потенциальные ошибки при ручном деплое + трата человеческих ресурсов.
6. База данных заказов обрабатывает как запросы на чтение, так и запросы на запись

## Разработка инициатив, которые необходимы для устранения нежелательных ситуаций

1. Настройка систем мониторинга, логирования, трейсинга.
2. Анализ причин долго отображения заказов в интерфейсе MES.
3. Настройка процесса CI/CD для release и production окружений (может потребовать привлечения дополнительных специалистов dev-ops)
4. Разработка автотестов на замену E2E тестирования (может потребовать привлечения дополнительных специалистов по автотестированию. 
На первое время можно обойтись усилиями специалиста по тестированию из команды (есть желание заниматься автоматизацией + наличие прототипов).)
5. Разработка нагрузочных тестов (потребует специалиста по разработке нагрузочных тестов)
6. Внедрение системы кэширования данных.
7. Разделение Shop DB на read и write реплики.

## Расстановка приоритетов

В первую очередь необходимо решать бизнес проблемы. Обработка заказов замедлилась, компания теряет клиентов, что ведет 
к финансовым и репутационным потерям. Следом стоит разобрать причины долгого отображения заказов в интерфейсе MES. Далее 
следует поработать над ускорением выпуска релизов (для оперативной поставки изменений). В последнюю очередь стоит заняться 
оптимизацией работы функциональности (часть проблем уже известа, часть будет выявлена после внедрения системы мониторинга).

Исходя из выставленных приоритетов можно выделить наиболее важные инициативы:
1. Настройка систем мониторинга, логирования, трейсинга.
2. Разработка автотестов на замену E2E тестирования.
3. Анализ причин долго отображения заказов в интерфейсе MES.
4. Настройка лимитирования запросов

Предполагается, что через полгода архитектура продукта будет выглядеть следующим образом:
К первоначальным компонентам системы ([описание текущей архитектуры](jewerly_c4_model.drawio)) будут добавлены следующие компоненты:
1. Подсистема мониторинга. В качестве time series db будет использоваться Prometheus. У каждой компоненты системы будет реализован адаптер,
по которому prometheus будет получать метрики. Мониторинг метрик будет осуществляться через Grafana
2. Подсистема логирования. Будет включать в себя:  
   2.1. Компонент Logstash, отвечающий за централизованный сбор логов из разных источников,  
   2.2. Компонент Elastic Search, отвечающий за хранение и предоставление API по поиску по собранным логам.  
   2.3. Компонент Kibana, отвещающий за предоставление визуального интерфейса для просмотра собранных логов.  
3. Подсистема трейсинга. За сбор трассировок и их визуализацию будут отвечать Jaeger + Jaeger UI.
4. Подсистема кэширования. Будет использован Redis.

Также общий инстанс Shop DB будет заменен на кластер с Read и Write репликами.


